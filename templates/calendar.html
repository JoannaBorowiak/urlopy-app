{% extends "base.html" %}

{% block title %}Kalendarz urlopów{% endblock %}

{% block content %}
<h2 class="mb-4">Kalendarz urlopów</h2>
<div id="calendar"></div>
<style>
  .fc .fc-col-header-cell-cushion,
  .fc .fc-daygrid-day-number {
    color: black !important;
  }

  .fc .fc-button {
    background-color: #0d6efd !important;
    border-color: #0d6efd !important;
    color: white !important;
    font-weight: 500;
  }

  .fc .fc-button:hover {
    background-color: #0b5ed7 !important;
    border-color: #0a58ca !important;
  }

  .fc .fc-toolbar-title {
    color: #0d6efd;
    font-weight: 600;
    font-size: 1.3rem;
  }
</style>

<link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
    var calendarEl = document.getElementById('calendar');

    // Przypisanie kolorów do user_id
    const userColors = {
        {% for leave in leaves %}
        {{ leave.user_id }}: '{{ ['#007bff', '#28a745', '#dc3545', '#ffc107', '#6610f2', '#17a2b8', '#6f42c1', '#fd7e14'][(loop.index0) % 8] }}'{% if not loop.last %},{% endif %}
        {% endfor %}
    };

    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        locale: 'pl',
        firstDay:1, // poniedziałek pierwszy dzień
        events: [
            {% for leave in leaves %}
            {
                title: '{{ leave.owner.name }}',
                start: '{{ leave.date_from }}',
                end: '{{ leave.date_to }}T23:59:59',
                allDay: true,
                color: userColors[{{ leave.user_id }}]
            }{% if not loop.last %},{% endif %}
            {% endfor %}
        ]
    });
    calendar.render();
});
</script>
{% endblock %}
